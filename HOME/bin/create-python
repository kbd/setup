#!/usr/bin/env python3
import sys

from plumbum.cmd import cd, direnv, echo, git, mkdir, poetry

# create directory
mkdir(sys.argv[1])
cd(sys.argv[1])

# initialize poetry with default dependencies, create virtualenv
poetry('init',
  '--no-interaction',
  '--name', sys.argv[1],
  '--author', git('config', '--get', '--global', 'user.name').strip(),
  '--dev-dependency=black',
  '--dev-dependency=ipython',
  '--dev-dependency=mypy',
  '--dev-dependency=pylint',
  '--dev-dependency=pytest',
)
poetry('install')

# set up direnv
(echo > '.envrc')("layout poetry")
direnv('allow')

# add files to git
git('init')
git('add', '--all')
