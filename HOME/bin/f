#!/usr/bin/env python3
"""
Split stdin on fields.

Like awk -F[delim] '{print $1; $print $2, ...}', but shorter.
"""
import fileinput
import os
import sys


def usage():
    print("f [delim] index[,index2,...] (index is int, or Python-like slice: eg 0:10:2)")


def parse_index(index):
    result = []
    for items in index.split(','):
        range_ = items.split(':')
        if len(range_) > 3:
            print(f"Invalid slice: '{range_}'", file=sys.stderr)
            continue

        if len(range_) == 1:  # no range
            result.append(int(*range_))
        else:
            result.append(slice(*(int(i) if i else None for i in range_)))

    return result


def main(args):
    if not 2 <= len(args) <= 3:
        usage()
        sys.exit(1)

    delim, index = [None] * (3 - len(args)) + args[1:]
    index = parse_index(index)
    for line in fileinput.input('-'):
        parts = line.rstrip().split(delim)
        for i in index:
            try:
                if isinstance(i, int):
                    print(parts[i])
                else:
                    print(*parts[i])
            except IndexError:
                print()


if __name__ == "__main__":
    try:
        main(sys.argv)
        sys.stdout.flush()
    except (KeyboardInterrupt, BrokenPipeError):
        # https://docs.python.org/3/library/signal.html#note-on-sigpipe
        devnull = os.open(os.devnull, os.O_WRONLY)
        os.dup2(devnull, sys.stdout.fileno())
        sys.exit(1)
