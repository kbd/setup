#!/usr/bin/env python3
import argparse
import subprocess
import sys


def getpass(key):
    cmd = ["op", "get", "item", key, "--fields", "password"]
    result = subprocess.run(cmd, capture_output=True, text=True)
    return result


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Get password from password manager")
    parser.add_argument("key", help="The name of the account to get the password")
    args = parser.parse_args()

    result = getpass(args.key)
    if not result.returncode:
        print(result.stdout.strip())
    else:
        print(result.stderr.strip())
        sys.exit(result.returncode)
